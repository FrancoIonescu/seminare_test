SELECT c.nume_client
COUNT(cm.id_comanda as numar_comenzi,
Sum(RC.PRET*RC.CANTITATE) AS valoare_totala,
0.1*SUM(RC.PRET*RC.CANTITATE) AS COMISION
FROM COMENZI CM
JOIN CLIENTI C ON C.ID_CLIENT = CM.ID_CLIENT
JOIN RAND_COMENZI RC = RC.ID_COMANDA = C.ID_COMANDA
GROUP BY C.NUME_CLIENT
HAVING COUNT(CM.ID_COMANDA) = 1

UNION

SELECT c.nume_client
COUNT(cm.id_comanda as numar_comenzi,
Sum(RC.PRET*RC.CANTITATE) AS valoare_totala,
0.2*SUM(RC.PRET*RC.CANTITATE) AS COMISION
FROM COMENZI CM
JOIN CLIENTI C ON C.ID_CLIENT = CM.ID_CLIENT
JOIN RAND_COMENZI RC = RC.ID_COMANDA = C.ID_COMANDA
GROUP BY C.NUME_CLIENT
HAVING COUNT(CM.ID_COMANDA) = 2

UNION 

SELECT c.nume_client
COUNT(cm.id_comanda as numar_comenzi,
Sum(RC.PRET*RC.CANTITATE) AS valoare_totala,
0.3*SUM(RC.PRET*RC.CANTITATE) AS COMISION
FROM COMENZI CM
JOIN CLIENTI C ON C.ID_CLIENT = CM.ID_CLIENT
JOIN RAND_COMENZI RC = RC.ID_COMANDA = C.ID_COMANDA
GROUP BY C.NUME_CLIENT
HAVING COUNT(CM.ID_COMANDA) = 3


